{"ast":null,"code":"var _jsxFileName = \"/Users/griffinbaker/Desktop/chat-application/client/src/components/message-view/message-view.component.jsx\",\n    _s = $RefreshSig$();\n\nimport { useCallback, useEffect, useState, Fragment } from 'react';\nimport Lottie from 'lottie-react';\nimport { useChatView } from '../../contexts/chat-view-context';\nimport Spinner from '../spinner/spinner.component';\nimport './message-view.styles.scss';\nimport { useAuthentication } from '../../contexts/authentication-context';\nimport animationData from '../../animations/typing.json';\nimport { defaultToast, sameSenderAndNotCurrentUser, TOAST_TYPE, userSent, getTyperString } from '../../utils/utils';\nimport { useSocket } from '../../contexts/socket-context'; // Could definitely add timestamp data to the message as well, that would be pretty clean actually\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nlet typingTimer;\n\nconst MessageView = () => {\n  _s();\n\n  // Somehow we are going to have to get all of the message in a conversation potentially and then mark whether or not they are your messages or someone else's to style accordingly;\n  const {\n    currentUser\n  } = useAuthentication();\n  const {\n    activeChat,\n    setNotifications,\n    setReloadCircuit,\n    unreadMessages,\n    setUnreadMessages\n  } = useChatView();\n  const {\n    socket,\n    onlineUsers\n  } = useSocket();\n  const [messages, setMessages] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isTyping, setIsTyping] = useState(false);\n  const [typing, setTyping] = useState(false);\n  const [typers, setTypers] = useState([]);\n  useEffect(() => {\n    const handleKeyPress = e => {\n      if (e.key === 'Escape') setUnreadMessages([]);\n    };\n\n    window.addEventListener('keypress', handleKeyPress);\n    return () => window.addEventListener('keypress', handleKeyPress);\n  }, [setUnreadMessages]);\n\n  const handleKeyDown = async e => {\n    if (!socket) return;\n    const newMessage = e.target.innerHTML;\n\n    if (e.key === 'Enter' && newMessage) {\n      e.preventDefault();\n      e.target.innerHTML = '';\n      setReloadCircuit(true);\n\n      try {\n        const response = await fetch(`http://localhost:4000/api/message`, {\n          method: 'post',\n          headers: {\n            Authorization: `Bearer ${currentUser.token}`,\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            chatId: activeChat[0]._id,\n            text: newMessage\n          })\n        });\n        const message = await response.json();\n        socket.emit('send-msg', message);\n        setMessages(prevState => [...prevState, message]);\n        setUnreadMessages([]);\n        setTyping(false);\n        socket.emit('chat update', message.chat);\n        const usersOtherThanCurrentAndOffline = [];\n        message.chat.users.forEach(user => {\n          if (user._id === currentUser._id) return;\n          const isOnline = onlineUsers.some(onlineUserArr => onlineUserArr.includes(user._id));\n          if (!isOnline) usersOtherThanCurrentAndOffline.push(user);\n        }); // Log the notification for every user that is offline so it appears when they log in\n\n        usersOtherThanCurrentAndOffline.forEach(async user => {\n          await fetch(`http://localhost:4000/api/notification/addNotification`, {\n            method: 'post',\n            headers: {\n              Authorization: `Bearer ${currentUser.token}`,\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              message,\n              userId: user._id\n            })\n          });\n        });\n      } catch (error) {\n        defaultToast(TOAST_TYPE.error, 'Error sending');\n      }\n    } else {\n      if (!typing) {\n        setTyping(true);\n        socket.emit('typing', activeChat[0]._id, currentUser);\n      }\n\n      const lastTypingTime = new Date().getTime();\n      const timerLength = 3000;\n      if (typingTimer) clearTimeout(typingTimer);\n      typingTimer = setTimeout(() => {\n        const timeNow = new Date().getTime();\n        const timeDiff = timeNow - lastTypingTime;\n\n        if (timeDiff >= timerLength) {\n          socket.emit('stop typing', activeChat[0]._id, currentUser);\n          setTyping(false);\n        }\n      }, timerLength);\n    }\n  };\n\n  const fetchMessages = useCallback(async () => {\n    if (!socket) return;\n    if (!activeChat) return;\n    setIsLoading(true);\n    const response = await fetch(`http://localhost:4000/api/message/${activeChat[0]._id}`, {\n      method: 'get',\n      headers: {\n        Authorization: `Bearer ${currentUser.token}`\n      }\n    });\n    const messages = await response.json();\n    setMessages(messages);\n    setIsLoading(false);\n  }, [activeChat, currentUser.token, socket]);\n  useEffect(() => {\n    fetchMessages();\n  }, [fetchMessages, activeChat]);\n  useEffect(() => {\n    if (!socket) return;\n    socket.emit('join room', activeChat[0]._id);\n    socket.emit('stop typing', activeChat[0]._id, currentUser);\n    return () => socket.emit('leave room', activeChat[0]._id);\n  }, [activeChat, socket, currentUser]);\n  useEffect(() => {\n    if (!socket) return;\n    socket.on('msg-received', async message => {\n      if (!activeChat[0]._id || message.chat._id !== activeChat[0]._id) {\n        try {\n          const response = await fetch(`http://localhost:4000/api/notification/addNotification`, {\n            method: 'post',\n            headers: {\n              Authorization: `Bearer ${currentUser.token}`,\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              message\n            })\n          });\n          const notification = await response.json();\n          setNotifications(prevState => [notification, ...prevState]);\n        } catch (error) {\n          defaultToast(TOAST_TYPE.error, 'Error setting notifications');\n        }\n      } else {\n        setIsTyping(false);\n        setMessages(prevState => [...prevState, message]);\n        setUnreadMessages([]);\n      }\n    });\n    return () => socket.off('msg-received');\n  }, [socket, activeChat, setNotifications, currentUser.token, setUnreadMessages]);\n  useEffect(() => {\n    setIsTyping(false);\n  }, [activeChat]);\n  useEffect(() => {\n    if (!socket) return;\n    socket.on('typing', typer => {\n      setIsTyping(true);\n      setTypers(prevState => [...new Set([typer, ...prevState])]);\n    });\n    socket.on('stop typing', userName => {\n      const usersStillTyping = typers.filter(typer => typer !== userName);\n\n      if (usersStillTyping.length > 0 && typers.length !== 0) {\n        setIsTyping(true);\n        setTypers(usersStillTyping);\n        return;\n      }\n\n      setIsTyping(false);\n      setTypers([]);\n    });\n    return () => {\n      socket.off('typing');\n      socket.off('stop typing');\n    };\n  }, [socket, typers]); // useEffect(() => {\n  //   setUnreadMessages([]);\n  // }, []);\n\n  const handleScroll = e => {\n    console.log('we scrolling');\n    const bottom = e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight;\n    if (bottom) setUnreadMessages([]);\n  };\n\n  const setRef = useCallback(node => {\n    if (node && isTyping && isScrolledIntoView(node)) {\n      node.scrollIntoView({\n        smooth: true\n      });\n    } else if (node && !isTyping) {\n      node.scrollIntoView({\n        smooth: true\n      });\n    }\n  }, [isTyping]);\n\n  const isScrolledIntoView = el => {\n    var rect = el.getBoundingClientRect();\n    var elemTop = rect.top;\n    var elemBottom = rect.bottom; // Only completely visible elements return true:\n\n    var isVisible = elemTop >= 0 && elemBottom <= window.innerHeight; // Partially visible elements return true:\n    //isVisible = elemTop < window.innerHeight && elemBottom >= 0;\n\n    return isVisible;\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"message-view-container\",\n    children: isLoading ? /*#__PURE__*/_jsxDEV(Spinner, {\n      type: \"search\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        onScrolle: handleScroll,\n        className: \"message-view-active-chat-container\",\n        children: messages.length > 0 && messages.map((message, i) => {\n          const lastMessageBool = messages.length - 1 === i + 1;\n          const userSentBool = userSent(currentUser, message);\n          const sameSenderAndNotCurrentUserBool = sameSenderAndNotCurrentUser(i, messages, currentUser);\n\n          const firstUnreadMessage = unreadMessages.length > 0 && unreadMessages.at(-1).message._id === message._id;\n\n          return /*#__PURE__*/_jsxDEV(Fragment, {\n            children: [firstUnreadMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: setRef,\n              className: \"first-unread-message-container\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"New\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 25\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 23\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: lastMessageBool && unreadMessages.length === 0 ? setRef : null,\n              style: i === 0 ? {\n                paddingTop: '6px'\n              } : {},\n              className: `message-view-message-container ${userSentBool ? 'user-sent' : ''}`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"message-view-message-image-container\",\n                style: sameSenderAndNotCurrentUserBool || userSentBool ? {\n                  visibility: 'hidden'\n                } : {\n                  marginTop: '2px'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  height: \"100%\",\n                  src: message.sender.picture,\n                  alt: \"profile\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 296,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 288,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"message-view-text-container\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"message-view-text\",\n                  children: message.text\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 303,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: sameSenderAndNotCurrentUserBool || userSentBool ? {\n                    display: 'none'\n                  } : {},\n                  className: \"message-view-text-info\",\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: [\"@\", !userSentBool ? message.sender.userName : 'You']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 312,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 304,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 302,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 21\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 19\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 11\n      }, this), isTyping && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lottie-container\",\n        children: [typers.length ? getTyperString(typers) : '', /*#__PURE__*/_jsxDEV(Lottie, {\n          animationData: animationData,\n          loop: true,\n          autoplay: true,\n          style: {\n            height: '16px',\n            display: 'block'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"send-message-editable\",\n        \"data-text\": `Message `,\n        contentEditable: true,\n        onKeyDown: handleKeyDown\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 247,\n    columnNumber: 5\n  }, this);\n};\n\n_s(MessageView, \"7boywgJDnBuZQ+qVWwpJSYfntXU=\", false, function () {\n  return [useAuthentication, useChatView, useSocket];\n});\n\n_c = MessageView;\nexport default MessageView;\n\nvar _c;\n\n$RefreshReg$(_c, \"MessageView\");","map":{"version":3,"names":["useCallback","useEffect","useState","Fragment","Lottie","useChatView","Spinner","useAuthentication","animationData","defaultToast","sameSenderAndNotCurrentUser","TOAST_TYPE","userSent","getTyperString","useSocket","typingTimer","MessageView","currentUser","activeChat","setNotifications","setReloadCircuit","unreadMessages","setUnreadMessages","socket","onlineUsers","messages","setMessages","isLoading","setIsLoading","isTyping","setIsTyping","typing","setTyping","typers","setTypers","handleKeyPress","e","key","window","addEventListener","handleKeyDown","newMessage","target","innerHTML","preventDefault","response","fetch","method","headers","Authorization","token","body","JSON","stringify","chatId","_id","text","message","json","emit","prevState","chat","usersOtherThanCurrentAndOffline","users","forEach","user","isOnline","some","onlineUserArr","includes","push","userId","error","lastTypingTime","Date","getTime","timerLength","clearTimeout","setTimeout","timeNow","timeDiff","fetchMessages","on","notification","off","typer","Set","userName","usersStillTyping","filter","length","handleScroll","console","log","bottom","scrollHeight","scrollTop","clientHeight","setRef","node","isScrolledIntoView","scrollIntoView","smooth","el","rect","getBoundingClientRect","elemTop","top","elemBottom","isVisible","innerHeight","map","i","lastMessageBool","userSentBool","sameSenderAndNotCurrentUserBool","firstUnreadMessage","at","paddingTop","visibility","marginTop","sender","picture","display","height"],"sources":["/Users/griffinbaker/Desktop/chat-application/client/src/components/message-view/message-view.component.jsx"],"sourcesContent":["import { useCallback, useEffect, useState, Fragment } from 'react';\nimport Lottie from 'lottie-react';\nimport { useChatView } from '../../contexts/chat-view-context';\nimport Spinner from '../spinner/spinner.component';\nimport './message-view.styles.scss';\nimport { useAuthentication } from '../../contexts/authentication-context';\nimport animationData from '../../animations/typing.json';\nimport {\n  defaultToast,\n  sameSenderAndNotCurrentUser,\n  TOAST_TYPE,\n  userSent,\n  getTyperString,\n} from '../../utils/utils';\nimport { useSocket } from '../../contexts/socket-context';\n\n// Could definitely add timestamp data to the message as well, that would be pretty clean actually\n\nlet typingTimer;\n\nconst MessageView = () => {\n  // Somehow we are going to have to get all of the message in a conversation potentially and then mark whether or not they are your messages or someone else's to style accordingly;\n  const { currentUser } = useAuthentication();\n  const {\n    activeChat,\n    setNotifications,\n    setReloadCircuit,\n    unreadMessages,\n    setUnreadMessages,\n  } = useChatView();\n  const { socket, onlineUsers } = useSocket();\n\n  const [messages, setMessages] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isTyping, setIsTyping] = useState(false);\n  const [typing, setTyping] = useState(false);\n  const [typers, setTypers] = useState([]);\n\n  useEffect(() => {\n    const handleKeyPress = e => {\n      if (e.key === 'Escape') setUnreadMessages([]);\n    };\n    window.addEventListener('keypress', handleKeyPress);\n    return () => window.addEventListener('keypress', handleKeyPress);\n  }, [setUnreadMessages]);\n\n  const handleKeyDown = async e => {\n    if (!socket) return;\n    const newMessage = e.target.innerHTML;\n    if (e.key === 'Enter' && newMessage) {\n      e.preventDefault();\n      e.target.innerHTML = '';\n      setReloadCircuit(true);\n      try {\n        const response = await fetch(`http://localhost:4000/api/message`, {\n          method: 'post',\n          headers: {\n            Authorization: `Bearer ${currentUser.token}`,\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            chatId: activeChat[0]._id,\n            text: newMessage,\n          }),\n        });\n        const message = await response.json();\n        socket.emit('send-msg', message);\n        setMessages(prevState => [...prevState, message]);\n        setUnreadMessages([]);\n        setTyping(false);\n        socket.emit('chat update', message.chat);\n\n        const usersOtherThanCurrentAndOffline = [];\n        message.chat.users.forEach(user => {\n          if (user._id === currentUser._id) return;\n          const isOnline = onlineUsers.some(onlineUserArr =>\n            onlineUserArr.includes(user._id)\n          );\n          if (!isOnline) usersOtherThanCurrentAndOffline.push(user);\n        });\n\n        // Log the notification for every user that is offline so it appears when they log in\n        usersOtherThanCurrentAndOffline.forEach(async user => {\n          await fetch(\n            `http://localhost:4000/api/notification/addNotification`,\n            {\n              method: 'post',\n              headers: {\n                Authorization: `Bearer ${currentUser.token}`,\n                'Content-Type': 'application/json',\n              },\n              body: JSON.stringify({\n                message,\n                userId: user._id,\n              }),\n            }\n          );\n        });\n      } catch (error) {\n        defaultToast(TOAST_TYPE.error, 'Error sending');\n      }\n    } else {\n      if (!typing) {\n        setTyping(true);\n        socket.emit('typing', activeChat[0]._id, currentUser);\n      }\n      const lastTypingTime = new Date().getTime();\n      const timerLength = 3000;\n      if (typingTimer) clearTimeout(typingTimer);\n      typingTimer = setTimeout(() => {\n        const timeNow = new Date().getTime();\n        const timeDiff = timeNow - lastTypingTime;\n        if (timeDiff >= timerLength) {\n          socket.emit('stop typing', activeChat[0]._id, currentUser);\n          setTyping(false);\n        }\n      }, timerLength);\n    }\n  };\n\n  const fetchMessages = useCallback(async () => {\n    if (!socket) return;\n    if (!activeChat) return;\n    setIsLoading(true);\n    const response = await fetch(\n      `http://localhost:4000/api/message/${activeChat[0]._id}`,\n      {\n        method: 'get',\n        headers: { Authorization: `Bearer ${currentUser.token}` },\n      }\n    );\n    const messages = await response.json();\n    setMessages(messages);\n    setIsLoading(false);\n  }, [activeChat, currentUser.token, socket]);\n\n  useEffect(() => {\n    fetchMessages();\n  }, [fetchMessages, activeChat]);\n\n  useEffect(() => {\n    if (!socket) return;\n    socket.emit('join room', activeChat[0]._id);\n    socket.emit('stop typing', activeChat[0]._id, currentUser);\n    return () => socket.emit('leave room', activeChat[0]._id);\n  }, [activeChat, socket, currentUser]);\n\n  useEffect(() => {\n    if (!socket) return;\n    socket.on('msg-received', async message => {\n      if (!activeChat[0]._id || message.chat._id !== activeChat[0]._id) {\n        try {\n          const response = await fetch(\n            `http://localhost:4000/api/notification/addNotification`,\n            {\n              method: 'post',\n              headers: {\n                Authorization: `Bearer ${currentUser.token}`,\n                'Content-Type': 'application/json',\n              },\n              body: JSON.stringify({\n                message,\n              }),\n            }\n          );\n          const notification = await response.json();\n          setNotifications(prevState => [notification, ...prevState]);\n        } catch (error) {\n          defaultToast(TOAST_TYPE.error, 'Error setting notifications');\n        }\n      } else {\n        setIsTyping(false);\n        setMessages(prevState => [...prevState, message]);\n        setUnreadMessages([]);\n      }\n    });\n    return () => socket.off('msg-received');\n  }, [\n    socket,\n    activeChat,\n    setNotifications,\n    currentUser.token,\n    setUnreadMessages,\n  ]);\n\n  useEffect(() => {\n    setIsTyping(false);\n  }, [activeChat]);\n\n  useEffect(() => {\n    if (!socket) return;\n    socket.on('typing', typer => {\n      setIsTyping(true);\n      setTypers(prevState => [...new Set([typer, ...prevState])]);\n    });\n    socket.on('stop typing', userName => {\n      const usersStillTyping = typers.filter(typer => typer !== userName);\n      if (usersStillTyping.length > 0 && typers.length !== 0) {\n        setIsTyping(true);\n        setTypers(usersStillTyping);\n        return;\n      }\n      setIsTyping(false);\n      setTypers([]);\n    });\n    return () => {\n      socket.off('typing');\n      socket.off('stop typing');\n    };\n  }, [socket, typers]);\n\n  // useEffect(() => {\n  //   setUnreadMessages([]);\n  // }, []);\n\n  const handleScroll = e => {\n    console.log('we scrolling');\n    const bottom =\n      e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight;\n    if (bottom) setUnreadMessages([]);\n  };\n\n  const setRef = useCallback(\n    node => {\n      if (node && isTyping && isScrolledIntoView(node)) {\n        node.scrollIntoView({ smooth: true });\n      } else if (node && !isTyping) {\n        node.scrollIntoView({ smooth: true });\n      }\n    },\n    [isTyping]\n  );\n\n  const isScrolledIntoView = el => {\n    var rect = el.getBoundingClientRect();\n    var elemTop = rect.top;\n    var elemBottom = rect.bottom;\n\n    // Only completely visible elements return true:\n    var isVisible = elemTop >= 0 && elemBottom <= window.innerHeight;\n    // Partially visible elements return true:\n    //isVisible = elemTop < window.innerHeight && elemBottom >= 0;\n    return isVisible;\n  };\n\n  return (\n    <div className=\"message-view-container\">\n      {isLoading ? (\n        <Spinner type=\"search\" />\n      ) : (\n        <>\n          <div\n            onScrolle={handleScroll}\n            className=\"message-view-active-chat-container\"\n          >\n            {messages.length > 0 &&\n              messages.map((message, i) => {\n                const lastMessageBool = messages.length - 1 === i + 1;\n                const userSentBool = userSent(currentUser, message);\n                const sameSenderAndNotCurrentUserBool =\n                  sameSenderAndNotCurrentUser(i, messages, currentUser);\n                const firstUnreadMessage =\n                  unreadMessages.length > 0 &&\n                  unreadMessages.at(-1).message._id === message._id;\n\n                return (\n                  <Fragment key={i}>\n                    {firstUnreadMessage && (\n                      <div\n                        ref={setRef}\n                        className=\"first-unread-message-container\"\n                      >\n                        <p>New</p>\n                      </div>\n                    )}\n\n                    <div\n                      ref={\n                        lastMessageBool && unreadMessages.length === 0\n                          ? setRef\n                          : null\n                      }\n                      style={i === 0 ? { paddingTop: '6px' } : {}}\n                      className={`message-view-message-container ${\n                        userSentBool ? 'user-sent' : ''\n                      }`}\n                    >\n                      <div\n                        className=\"message-view-message-image-container\"\n                        style={\n                          sameSenderAndNotCurrentUserBool || userSentBool\n                            ? { visibility: 'hidden' }\n                            : { marginTop: '2px' }\n                        }\n                      >\n                        <img\n                          height=\"100%\"\n                          src={message.sender.picture}\n                          alt=\"profile\"\n                        />\n                      </div>\n                      <div className=\"message-view-text-container\">\n                        <div className=\"message-view-text\">{message.text}</div>\n                        <div\n                          style={\n                            sameSenderAndNotCurrentUserBool || userSentBool\n                              ? { display: 'none' }\n                              : {}\n                          }\n                          className=\"message-view-text-info\"\n                        >\n                          <p>\n                            @{!userSentBool ? message.sender.userName : 'You'}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  </Fragment>\n                );\n              })}\n          </div>\n\n          {isTyping && (\n            <div className=\"lottie-container\">\n              {typers.length ? getTyperString(typers) : ''}\n              <Lottie\n                animationData={animationData}\n                loop={true}\n                autoplay={true}\n                style={{ height: '16px', display: 'block' }}\n              />\n            </div>\n          )}\n\n          <div\n            className=\"send-message-editable\"\n            data-text={`Message `}\n            contentEditable\n            onKeyDown={handleKeyDown}\n          />\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default MessageView;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}