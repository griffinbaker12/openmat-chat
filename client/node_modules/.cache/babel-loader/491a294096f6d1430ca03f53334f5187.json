{"ast":null,"code":"import _slicedToArray from\"/Users/griffinbaker/Desktop/chat-application/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createContext,useContext,useEffect,useState}from'react';import{io}from'socket.io-client';import{useAuthentication}from'./authentication-context';import{jsx as _jsx}from\"react/jsx-runtime\";var SocketContext=/*#__PURE__*/createContext();export var useSocket=function useSocket(){return useContext(SocketContext);};var ENDPOINT='https://openmat-chat.herokuapp.com';export var SocketProvider=function SocketProvider(_ref){var children=_ref.children;var _useState=useState(),_useState2=_slicedToArray(_useState,2),socket=_useState2[0],setSocket=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),onlineUsers=_useState4[0],setOnlineUsers=_useState4[1];var _useAuthentication=useAuthentication(),currentUser=_useAuthentication.currentUser;useEffect(function(){if(!currentUser)return;var newSocket=io(ENDPOINT);newSocket.emit('setup',currentUser._id);setSocket(newSocket);newSocket.on('logged in user change',function(users){var onlineUserArr=users.map(function(_ref2){var _ref3=_slicedToArray(_ref2,2),socketId=_ref3[0],userId=_ref3[1];return[socketId,userId];});setOnlineUsers(onlineUserArr);});return function(){newSocket.emit('test','hey');newSocket.off('logged in user change');setOnlineUsers(function(prevState){var newOnlineUsers=prevState.filter(function(user){return user!==(currentUser===null||currentUser===void 0?void 0:currentUser._id);});return newOnlineUsers;});};},[currentUser]);return/*#__PURE__*/_jsx(SocketContext.Provider,{value:{socket:socket,onlineUsers:onlineUsers},children:children});};","map":{"version":3,"names":["createContext","useContext","useEffect","useState","io","useAuthentication","SocketContext","useSocket","ENDPOINT","SocketProvider","children","socket","setSocket","onlineUsers","setOnlineUsers","currentUser","newSocket","emit","_id","on","users","onlineUserArr","map","socketId","userId","off","prevState","newOnlineUsers","filter","user"],"sources":["/Users/griffinbaker/Desktop/chat-application/client/src/contexts/socket-context.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from 'react';\nimport { io } from 'socket.io-client';\nimport { useAuthentication } from './authentication-context';\n\nconst SocketContext = createContext();\n\nexport const useSocket = () => useContext(SocketContext);\n\nconst ENDPOINT = 'https://openmat-chat.herokuapp.com';\n\nexport const SocketProvider = ({ children }) => {\n  const [socket, setSocket] = useState();\n  const [onlineUsers, setOnlineUsers] = useState([]);\n\n  const { currentUser } = useAuthentication();\n\n  useEffect(() => {\n    if (!currentUser) return;\n    const newSocket = io(ENDPOINT);\n    newSocket.emit('setup', currentUser._id);\n    setSocket(newSocket);\n    newSocket.on('logged in user change', users => {\n      const onlineUserArr = users.map(([socketId, userId]) => [\n        socketId,\n        userId,\n      ]);\n      setOnlineUsers(onlineUserArr);\n    });\n    return () => {\n      newSocket.emit('test', 'hey');\n      newSocket.off('logged in user change');\n      setOnlineUsers(prevState => {\n        const newOnlineUsers = prevState.filter(\n          user => user !== currentUser?._id\n        );\n        return newOnlineUsers;\n      });\n    };\n  }, [currentUser]);\n\n  return (\n    <SocketContext.Provider value={{ socket, onlineUsers }}>\n      {children}\n    </SocketContext.Provider>\n  );\n};\n"],"mappings":"yIAAA,OAASA,aAAT,CAAwBC,UAAxB,CAAoCC,SAApC,CAA+CC,QAA/C,KAA+D,OAA/D,CACA,OAASC,EAAT,KAAmB,kBAAnB,CACA,OAASC,iBAAT,KAAkC,0BAAlC,C,2CAEA,GAAMC,cAAa,cAAGN,aAAa,EAAnC,CAEA,MAAO,IAAMO,UAAS,CAAG,QAAZA,UAAY,SAAMN,WAAU,CAACK,aAAD,CAAhB,EAAlB,CAEP,GAAME,SAAQ,CAAG,oCAAjB,CAEA,MAAO,IAAMC,eAAc,CAAG,QAAjBA,eAAiB,MAAkB,IAAfC,SAAe,MAAfA,QAAe,CAC9C,cAA4BP,QAAQ,EAApC,wCAAOQ,MAAP,eAAeC,SAAf,eACA,eAAsCT,QAAQ,CAAC,EAAD,CAA9C,yCAAOU,WAAP,eAAoBC,cAApB,eAEA,uBAAwBT,iBAAiB,EAAzC,CAAQU,WAAR,oBAAQA,WAAR,CAEAb,SAAS,CAAC,UAAM,CACd,GAAI,CAACa,WAAL,CAAkB,OAClB,GAAMC,UAAS,CAAGZ,EAAE,CAACI,QAAD,CAApB,CACAQ,SAAS,CAACC,IAAV,CAAe,OAAf,CAAwBF,WAAW,CAACG,GAApC,EACAN,SAAS,CAACI,SAAD,CAAT,CACAA,SAAS,CAACG,EAAV,CAAa,uBAAb,CAAsC,SAAAC,KAAK,CAAI,CAC7C,GAAMC,cAAa,CAAGD,KAAK,CAACE,GAAN,CAAU,kDAAEC,QAAF,UAAYC,MAAZ,gBAAwB,CACtDD,QADsD,CAEtDC,MAFsD,CAAxB,EAAV,CAAtB,CAIAV,cAAc,CAACO,aAAD,CAAd,CACD,CAND,EAOA,MAAO,WAAM,CACXL,SAAS,CAACC,IAAV,CAAe,MAAf,CAAuB,KAAvB,EACAD,SAAS,CAACS,GAAV,CAAc,uBAAd,EACAX,cAAc,CAAC,SAAAY,SAAS,CAAI,CAC1B,GAAMC,eAAc,CAAGD,SAAS,CAACE,MAAV,CACrB,SAAAC,IAAI,QAAIA,KAAI,IAAKd,WAAL,SAAKA,WAAL,iBAAKA,WAAW,CAAEG,GAAlB,CAAR,EADiB,CAAvB,CAGA,MAAOS,eAAP,CACD,CALa,CAAd,CAMD,CATD,CAUD,CAtBQ,CAsBN,CAACZ,WAAD,CAtBM,CAAT,CAwBA,mBACE,KAAC,aAAD,CAAe,QAAf,EAAwB,KAAK,CAAE,CAAEJ,MAAM,CAANA,MAAF,CAAUE,WAAW,CAAXA,WAAV,CAA/B,UACGH,QADH,EADF,CAKD,CAnCM"},"metadata":{},"sourceType":"module"}