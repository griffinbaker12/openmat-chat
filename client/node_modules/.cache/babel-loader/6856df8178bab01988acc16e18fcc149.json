{"ast":null,"code":"var _jsxFileName = \"/Users/griffinbaker/Desktop/chat-application/client/src/components/add-user-dropdown/add-user-dropdown.component.jsx\",\n    _s = $RefreshSig$();\n\nimport { Fragment, useState, useEffect, useRef } from 'react';\nimport { useAuthentication } from '../../contexts/authentication-context';\nimport { useChatView } from '../../contexts/chat-view-context';\nimport { TOAST_TYPE, defaultToast } from '../../utils/utils';\nimport SearchResult, { SEARCH_RESULT_TYPE } from '../search-result/search-result-component';\nimport './add-user-dropdown.styles.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst AddUserDropdown = _ref => {\n  _s();\n\n  let {\n    showAddUserDropdown,\n    setShowAddUserdropdown\n  } = _ref;\n  // const [userSearchText, setUserSearchText] = useState('');\n  const [userToAdd, setUserToAdd] = useState('');\n  const [userSearchResults, setUserSearchResults] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const {\n    currentUser\n  } = useAuthentication();\n  const {\n    activeChat\n  } = useChatView();\n\n  const handleTextChange = async e => {\n    const query = e.target.value;\n    console.log(query);\n\n    if (!query) {\n      console.log('hey');\n      setUserSearchResults([]);\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      const response = await fetch(`http://localhost:4000/api/user?search=${query}`, {\n        method: 'get',\n        headers: {\n          Authorization: `Bearer ${currentUser.token}`\n        }\n      });\n      const {\n        users\n      } = await response.json();\n      const usersNotAlreadyInChat = users.filter(returnedUser => {\n        return activeChat[0].users.some(chatUser => returnedUser.userName === chatUser.userName);\n      });\n      console.log(usersNotAlreadyInChat);\n      setIsLoading(false);\n      setUserSearchResults(users); // May also want to filter these by who is not in the curent chat, or could do this on the back end as well but may not be the right nove there, but could jsut incluce a little flag to hanle on the BE\n    } catch (e) {\n      defaultToast(TOAST_TYPE.error, 'Error adding user');\n    }\n  };\n\n  const handleAddUser = e => {\n    const closestContainer = e.target.closest('.add-user-dropdown-results-container');\n    const selectedId = closestContainer.getAttribute('name');\n    console.log('ac in dd', activeChat); // const alreadyExists = chatParticipants.some(\n    //   participant => participant._id === selectedId\n    // );\n    // if (alreadyExists) {\n    //   return;\n    // }\n    // const selectedUser = searchResults.find(\n    //   result => result?._id === selectedId\n    // );\n    // setChatParticipants(prevState => [...prevState, selectedUser]);\n    // setFormInput(prevState => ({ ...prevState, name: '' }));\n  }; // const addUserInputRef = useRef();\n  // const handleKeyDown = e => {\n  //   console.log('hello?');\n  // };\n  // useEffect(() => {\n  //   if (!addUserInputRef.current) return;\n  //   const keypress = new Event('keydown', {\n  //     bubbles: true,\n  //     cancelable: true,\n  //     keycode: 32,\n  //     which: 32,\n  //   });\n  //   addUserInputRef.current.focus();\n  //   addUserInputRef.current.dispatchEvent(keypress);\n  // }, [showAddUserDropdown]);\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"add-user-dropdown-container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"add-user-dropdown-tip bottom\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"add-user-dropdown-content-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"search\",\n          placeholder: \"Search users...\",\n          onChange: handleTextChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"add-user-dropdown-results-container\",\n          children: userSearchResults.map((searchResult, i) => /*#__PURE__*/_jsxDEV(Fragment, {\n            children: /*#__PURE__*/_jsxDEV(SearchResult, {\n              type: SEARCH_RESULT_TYPE.addUserToExistingChat,\n              handleAddUser: handleAddUser,\n              searchResult: searchResult\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 17\n            }, this)\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AddUserDropdown, \"+0B6ralVLAujuPVZj6rytGEYp0o=\", false, function () {\n  return [useAuthentication, useChatView];\n});\n\n_c = AddUserDropdown;\nexport default AddUserDropdown;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddUserDropdown\");","map":{"version":3,"names":["Fragment","useState","useEffect","useRef","useAuthentication","useChatView","TOAST_TYPE","defaultToast","SearchResult","SEARCH_RESULT_TYPE","AddUserDropdown","showAddUserDropdown","setShowAddUserdropdown","userToAdd","setUserToAdd","userSearchResults","setUserSearchResults","isLoading","setIsLoading","currentUser","activeChat","handleTextChange","e","query","target","value","console","log","response","fetch","method","headers","Authorization","token","users","json","usersNotAlreadyInChat","filter","returnedUser","some","chatUser","userName","error","handleAddUser","closestContainer","closest","selectedId","getAttribute","map","searchResult","i","addUserToExistingChat"],"sources":["/Users/griffinbaker/Desktop/chat-application/client/src/components/add-user-dropdown/add-user-dropdown.component.jsx"],"sourcesContent":["import { Fragment, useState, useEffect, useRef } from 'react';\nimport { useAuthentication } from '../../contexts/authentication-context';\nimport { useChatView } from '../../contexts/chat-view-context';\nimport { TOAST_TYPE, defaultToast } from '../../utils/utils';\nimport SearchResult, {\n  SEARCH_RESULT_TYPE,\n} from '../search-result/search-result-component';\nimport './add-user-dropdown.styles.scss';\n\nconst AddUserDropdown = ({ showAddUserDropdown, setShowAddUserdropdown }) => {\n  // const [userSearchText, setUserSearchText] = useState('');\n  const [userToAdd, setUserToAdd] = useState('');\n  const [userSearchResults, setUserSearchResults] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const { currentUser } = useAuthentication();\n  const { activeChat } = useChatView();\n\n  const handleTextChange = async e => {\n    const query = e.target.value;\n    console.log(query);\n    if (!query) {\n      console.log('hey');\n      setUserSearchResults([]);\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      const response = await fetch(\n        `http://localhost:4000/api/user?search=${query}`,\n        {\n          method: 'get',\n          headers: { Authorization: `Bearer ${currentUser.token}` },\n        }\n      );\n      const { users } = await response.json();\n\n      const usersNotAlreadyInChat = users.filter(returnedUser => {\n        return activeChat[0].users.some(\n          chatUser => returnedUser.userName === chatUser.userName\n        );\n      });\n\n      console.log(usersNotAlreadyInChat);\n\n      setIsLoading(false);\n\n      setUserSearchResults(users);\n\n      // May also want to filter these by who is not in the curent chat, or could do this on the back end as well but may not be the right nove there, but could jsut incluce a little flag to hanle on the BE\n    } catch (e) {\n      defaultToast(TOAST_TYPE.error, 'Error adding user');\n    }\n  };\n\n  const handleAddUser = e => {\n    const closestContainer = e.target.closest(\n      '.add-user-dropdown-results-container'\n    );\n    const selectedId = closestContainer.getAttribute('name');\n    console.log('ac in dd', activeChat);\n\n    // const alreadyExists = chatParticipants.some(\n    //   participant => participant._id === selectedId\n    // );\n\n    // if (alreadyExists) {\n    //   return;\n    // }\n\n    // const selectedUser = searchResults.find(\n    //   result => result?._id === selectedId\n    // );\n\n    // setChatParticipants(prevState => [...prevState, selectedUser]);\n    // setFormInput(prevState => ({ ...prevState, name: '' }));\n  };\n  // const addUserInputRef = useRef();\n\n  // const handleKeyDown = e => {\n  //   console.log('hello?');\n  // };\n\n  // useEffect(() => {\n  //   if (!addUserInputRef.current) return;\n  //   const keypress = new Event('keydown', {\n  //     bubbles: true,\n  //     cancelable: true,\n  //     keycode: 32,\n  //     which: 32,\n  //   });\n  //   addUserInputRef.current.focus();\n  //   addUserInputRef.current.dispatchEvent(keypress);\n  // }, [showAddUserDropdown]);\n\n  return (\n    <div className=\"add-user-dropdown-container\">\n      <div className=\"add-user-dropdown-tip bottom\">\n        <div className=\"add-user-dropdown-content-container\">\n          <input\n            type=\"search\"\n            placeholder=\"Search users...\"\n            onChange={handleTextChange}\n          />\n          <div className=\"add-user-dropdown-results-container\">\n            {userSearchResults.map((searchResult, i) => (\n              <Fragment key={i}>\n                <SearchResult\n                  type={SEARCH_RESULT_TYPE.addUserToExistingChat}\n                  handleAddUser={handleAddUser}\n                  searchResult={searchResult}\n                />\n              </Fragment>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AddUserDropdown;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}