{"ast":null,"code":"var _jsxFileName = \"/Users/griffinbaker/Desktop/chat-application/client/src/components/new-conversation-modal/new-conversation-modal.component.jsx\",\n    _s = $RefreshSig$();\n\nimport { Fragment } from 'react';\nimport { useRef, useState } from 'react';\nimport ChatParticipant from '../chat-participant/chat-participant.component';\nimport SearchResult from '../search-result/search-result-component';\nimport { useConversations } from '../../contexts/conversations-context';\nimport './new-conversation-modal.styles.scss';\nimport { useSidebar } from '../../contexts/sidebar-context';\nimport { useAuthentication } from '../../contexts/authentication-context'; // There seems to also totally be room to just have one modal component, and also a genreal button component as well, but for the modal, essentially I can just pass in the name of the modal itself, and then the body of the modal. The 'children' can just be the unique part of the actual form for these components that gets inserted into the overall block of the component\n// Will also need to add something where I can check if the user exists and as the person types have a little dropdown that can fill in suggestions? May not be necessary, but I know that discord does that and you can always @someone in that way, would be a nice feature to try and implement\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst NewConversationModal = () => {\n  _s();\n\n  const {\n    closeModal\n  } = useSidebar();\n  const {\n    createConversation\n  } = useConversations();\n  const [chatParticipants, setChatParticipants] = useState([]);\n  const [formInput, setFormInput] = useState({\n    chatName: '',\n    name: ''\n  });\n  const [isLoading, setIsLoading] = useState(false);\n  const {\n    currentUser\n  } = useAuthentication();\n  const [searchResults, setSearchResults] = useState([]); // So keep track of all the participants here, will need to search as well, then when we make the chat we send this to the api and push this into the current chat state of our application, also need to check to see if a chat with these users has already been made...\n  // This is fine for now, I guess at some point I need to make it clear whether or not you can submit this when you hit enter, or whether hitting enter adds people to the chat if there are none, but then it probably should stary like that as well even afterwards so may make the other button a button type as well\n\n  const handleSubmit = e => {\n    // // Will need to check somewhere to see if this person has already been added to the conversation, if they have, then don't allow them to create the convo. I also need a better UI that allows you to hit the enter button to add a user, but not submit the form and close the modal.\n    e.preventDefault();\n    handleAddUser();\n  };\n\n  const handleChatCreation = () => {\n    if (chatParticipants.length === 0) return; // createConversation(chatParticipants);\n    // closeModal();\n    // setFormInput({ chatName: '', name: '' });\n    // setChatParticipants([]);\n  };\n\n  const handleChange = async e => {\n    const field = e.target.getAttribute('name');\n    const query = e.target.value;\n    setFormInput(prevState => ({ ...prevState,\n      [field]: query\n    })); // If we are typing into the name field, then we want to make a fetch reqeust with the current value of the input\n\n    if (field !== 'name') return;\n\n    try {\n      fetch('');\n      setIsLoading(true);\n      const response = await fetch(`http://localhost:4000/api/user?search=${query}`, {\n        method: 'get',\n        headers: {\n          Authorization: `Bearer ${currentUser.token}`\n        }\n      });\n      const {\n        users\n      } = await response.json();\n      console.log(users);\n      setIsLoading(false);\n      setSearchResults(users);\n    } catch (e) {}\n  };\n\n  const handleAddUser = e => {\n    const selectedId = e.target.getAttribute('name');\n    const alreadyExists = chatParticipants.some(participant => participant._id === selectedId);\n\n    if (alreadyExists) {\n      return;\n    }\n\n    console.log('results are', searchResults);\n    const selectedUser = searchResults.find(result => (result === null || result === void 0 ? void 0 : result._id) === selectedId); // console.log(selectedUser);\n\n    setChatParticipants(prevState => [...prevState, selectedUser]);\n    setFormInput(prevState => ({ ...prevState,\n      name: ''\n    }));\n  };\n\n  const handleRemoveUser = e => {\n    const selectedId = e.target.getAttribute('name');\n    const newParticipants = chatParticipants.filter(participant => participant._id !== selectedId);\n    setChatParticipants(newParticipants);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"new-conversation-modal-body\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Chat Name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        onChange: handleChange,\n        type: \"text\",\n        required: true,\n        name: \"chatName\",\n        value: formInput.chatName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        onChange: handleChange,\n        type: \"text\",\n        required: chatParticipants.length > 0 ? false : true,\n        name: \"name\",\n        value: formInput.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this), chatParticipants.length === 0 ? '' : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"new-conversation-modal-chat-participant-container\",\n        children: chatParticipants.length !== 0 && chatParticipants.map((chatParticipant, i) => /*#__PURE__*/_jsxDEV(Fragment, {\n          children: /*#__PURE__*/_jsxDEV(ChatParticipant, {\n            chatParticipant: chatParticipant,\n            handleRemoveUser: handleRemoveUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 19\n          }, this)\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 17\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }, this), searchResults.length === 0 ? '' : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"new-conversation-modal-chat-search-result-container\",\n        children: searchResults.map((searchResult, i) => /*#__PURE__*/_jsxDEV(Fragment, {\n          children: /*#__PURE__*/_jsxDEV(SearchResult, {\n            handleAddUser: handleAddUser,\n            searchResult: searchResult\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 17\n          }, this)\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"new-conversation-modal-buttons\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: handleChatCreation,\n          children: \"Create Chat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 5\n  }, this);\n};\n\n_s(NewConversationModal, \"2+TFE+vn1E6f0QCxv9zS19g1iWw=\", false, function () {\n  return [useSidebar, useConversations, useAuthentication];\n});\n\n_c = NewConversationModal;\nexport default NewConversationModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"NewConversationModal\");","map":{"version":3,"names":["Fragment","useRef","useState","ChatParticipant","SearchResult","useConversations","useSidebar","useAuthentication","NewConversationModal","closeModal","createConversation","chatParticipants","setChatParticipants","formInput","setFormInput","chatName","name","isLoading","setIsLoading","currentUser","searchResults","setSearchResults","handleSubmit","e","preventDefault","handleAddUser","handleChatCreation","length","handleChange","field","target","getAttribute","query","value","prevState","fetch","response","method","headers","Authorization","token","users","json","console","log","selectedId","alreadyExists","some","participant","_id","selectedUser","find","result","handleRemoveUser","newParticipants","filter","map","chatParticipant","i","searchResult"],"sources":["/Users/griffinbaker/Desktop/chat-application/client/src/components/new-conversation-modal/new-conversation-modal.component.jsx"],"sourcesContent":["import { Fragment } from 'react';\nimport { useRef, useState } from 'react';\nimport ChatParticipant from '../chat-participant/chat-participant.component';\nimport SearchResult from '../search-result/search-result-component';\nimport { useConversations } from '../../contexts/conversations-context';\nimport './new-conversation-modal.styles.scss';\nimport { useSidebar } from '../../contexts/sidebar-context';\nimport { useAuthentication } from '../../contexts/authentication-context';\n\n// There seems to also totally be room to just have one modal component, and also a genreal button component as well, but for the modal, essentially I can just pass in the name of the modal itself, and then the body of the modal. The 'children' can just be the unique part of the actual form for these components that gets inserted into the overall block of the component\n\n// Will also need to add something where I can check if the user exists and as the person types have a little dropdown that can fill in suggestions? May not be necessary, but I know that discord does that and you can always @someone in that way, would be a nice feature to try and implement\n\nconst NewConversationModal = () => {\n  const { closeModal } = useSidebar();\n  const { createConversation } = useConversations();\n  const [chatParticipants, setChatParticipants] = useState([]);\n  const [formInput, setFormInput] = useState({ chatName: '', name: '' });\n  const [isLoading, setIsLoading] = useState(false);\n  const { currentUser } = useAuthentication();\n  const [searchResults, setSearchResults] = useState([]);\n\n  // So keep track of all the participants here, will need to search as well, then when we make the chat we send this to the api and push this into the current chat state of our application, also need to check to see if a chat with these users has already been made...\n\n  // This is fine for now, I guess at some point I need to make it clear whether or not you can submit this when you hit enter, or whether hitting enter adds people to the chat if there are none, but then it probably should stary like that as well even afterwards so may make the other button a button type as well\n\n  const handleSubmit = e => {\n    // // Will need to check somewhere to see if this person has already been added to the conversation, if they have, then don't allow them to create the convo. I also need a better UI that allows you to hit the enter button to add a user, but not submit the form and close the modal.\n    e.preventDefault();\n    handleAddUser();\n  };\n\n  const handleChatCreation = () => {\n    if (chatParticipants.length === 0) return;\n\n    // createConversation(chatParticipants);\n    // closeModal();\n    // setFormInput({ chatName: '', name: '' });\n    // setChatParticipants([]);\n  };\n\n  const handleChange = async e => {\n    const field = e.target.getAttribute('name');\n    const query = e.target.value;\n    setFormInput(prevState => ({ ...prevState, [field]: query }));\n\n    // If we are typing into the name field, then we want to make a fetch reqeust with the current value of the input\n    if (field !== 'name') return;\n\n    try {\n      fetch('');\n      setIsLoading(true);\n      const response = await fetch(\n        `http://localhost:4000/api/user?search=${query}`,\n        {\n          method: 'get',\n          headers: { Authorization: `Bearer ${currentUser.token}` },\n        }\n      );\n      const { users } = await response.json();\n      console.log(users);\n      setIsLoading(false);\n      setSearchResults(users);\n    } catch (e) {}\n  };\n\n  const handleAddUser = e => {\n    const selectedId = e.target.getAttribute('name');\n    const alreadyExists = chatParticipants.some(\n      participant => participant._id === selectedId\n    );\n\n    if (alreadyExists) {\n      return;\n    }\n\n    console.log('results are', searchResults);\n\n    const selectedUser = searchResults.find(\n      result => result?._id === selectedId\n    );\n\n    // console.log(selectedUser);\n\n    setChatParticipants(prevState => [...prevState, selectedUser]);\n    setFormInput(prevState => ({ ...prevState, name: '' }));\n  };\n\n  const handleRemoveUser = e => {\n    const selectedId = e.target.getAttribute('name');\n    const newParticipants = chatParticipants.filter(\n      participant => participant._id !== selectedId\n    );\n    setChatParticipants(newParticipants);\n  };\n\n  return (\n    <div className=\"new-conversation-modal-body\">\n      <form onSubmit={handleSubmit}>\n        <label>Chat Name</label>\n        <input\n          onChange={handleChange}\n          type=\"text\"\n          required={true}\n          name=\"chatName\"\n          value={formInput.chatName}\n        />\n        <label>Name</label>\n        <input\n          onChange={handleChange}\n          type=\"text\"\n          required={chatParticipants.length > 0 ? false : true}\n          name=\"name\"\n          value={formInput.name}\n        />\n        {/* So in here we need the searched users as well as the selected users */}\n\n        {/* Need to add some check here to only render when the length is over 0 so I do not get this error */}\n\n        {chatParticipants.length === 0 ? (\n          ''\n        ) : (\n          <div className=\"new-conversation-modal-chat-participant-container\">\n            {chatParticipants.length !== 0 &&\n              chatParticipants.map((chatParticipant, i) => (\n                <Fragment key={i}>\n                  <ChatParticipant\n                    chatParticipant={chatParticipant}\n                    handleRemoveUser={handleRemoveUser}\n                  />\n                </Fragment>\n              ))}\n          </div>\n        )}\n        {searchResults.length === 0 ? (\n          ''\n        ) : (\n          <div className=\"new-conversation-modal-chat-search-result-container\">\n            {searchResults.map((searchResult, i) => (\n              <Fragment key={i}>\n                <SearchResult\n                  handleAddUser={handleAddUser}\n                  searchResult={searchResult}\n                />\n              </Fragment>\n            ))}\n          </div>\n        )}\n        <div className=\"new-conversation-modal-buttons\">\n          <button type=\"button\" onClick={handleChatCreation}>\n            Create Chat\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default NewConversationModal;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}