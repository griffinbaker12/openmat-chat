{"ast":null,"code":"import _toConsumableArray from\"/Users/griffinbaker/Desktop/chat-application/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import{useEffect}from'react';// import { ReactComponent as SearchIcon } from '../../assets/search.svg';\nimport ChatPreview from'../chat-preview/chat-preview.component';import'./side-bar.styles.scss';import ContactPreview from'../contact-preview/contact-preview.component';import Spinner from'../spinner/spinner.component';import{useChatView,MODAL_TYPE}from'../../contexts/chat-view-context';import{useSocket}from'../../contexts/socket-context';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SideBar=function SideBar(){var _useSocket=useSocket(),socket=_useSocket.socket;var _useChatView=useChatView(),isChatViewLoading=_useChatView.isChatViewLoading,handleModal=_useChatView.handleModal,sideBarCategory=_useChatView.sideBarCategory,activeView=_useChatView.activeView,windowDimensions=_useChatView.windowDimensions,setChats=_useChatView.setChats,activeChat=_useChatView.activeChat,setActiveChat=_useChatView.setActiveChat,chats=_useChatView.chats;useEffect(function(){if(!socket)return;socket.on('updated chat',function(updatedChat){var removeFlag=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var updateFlag=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var checkForDuplicate=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;if(!removeFlag&&!updateFlag){setChats(function(prevState){var arr=prevState.map(function(chat){if(chat._id===updatedChat._id){return updatedChat;}else return chat;});return arr;});return;}if(removeFlag){setChats(function(prevState){return prevState.filter(function(chat){return chat._id!==updatedChat._id;});});return;}var priorChatUserNamesAndId=chats.map(function(chat){return[chat.users.map(function(_ref){var userName=_ref.userName;return userName;}).sort(),chat._id];});var updatedChatUserNames=_toConsumableArray(updatedChat.users).map(function(user){return user.userName;}).sort();var existingChatUsersAndId=priorChatUserNamesAndId.find(function(chat){if(chat[0].length!==updatedChatUserNames.length)return false;return chat[0].every(function(user,i){return user===updatedChatUserNames[i];});});if(existingChatUsersAndId&&checkForDuplicate){var existingChat=chats.find(function(chat){return chat._id===existingChatUsersAndId[1];});setActiveChat([existingChat]);setChats(function(prevState){return prevState.filter(function(chat){return chat._id!==updatedChat._id;});});return;}if(updateFlag&&activeChat[0]&&updatedChat._id===activeChat[0]._id){setActiveChat([updatedChat]);setChats(function(prevState){var arr=prevState.map(function(chat){if(chat._id===updatedChat._id){return updatedChat;}else return chat;});return arr;});return;}else if(updateFlag&&chats.some(function(chat){return chat._id===updatedChat._id;})){setChats(function(prevState){var arr=prevState.map(function(chat){if(chat._id===updatedChat._id){return updatedChat;}else return chat;});return arr;});return;}});return function(){return socket.off('updated chat');};},[socket,setChats,activeChat,setActiveChat,chats]);useEffect(function(){if(!socket)return;socket.on('chat creation',function(newChat){setChats(function(prevState){return[newChat].concat(_toConsumableArray(prevState));});});return function(){return socket.off('chat creation');};},[socket,setChats]);return/*#__PURE__*/_jsxs(\"div\",{style:windowDimensions.width>900?{width:'31%'}:activeView==='chat-preview'?{width:'100%'}:{display:'none'},className:\"side-bar-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"side-bar-header-title-container\",children:/*#__PURE__*/_jsx(\"p\",{children:\"My Chats\"})}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:'1'},children:[/*#__PURE__*/_jsx(ChatPreview,{}),isChatViewLoading?/*#__PURE__*/_jsx(Spinner,{type:\"search\"}):/*#__PURE__*/_jsx(ContactPreview,{})]}),/*#__PURE__*/_jsx(\"button\",{className:\"side-bar-container-generate-button\",onClick:function onClick(){return handleModal(MODAL_TYPE.sidebar);},type:\"button\",children:sideBarCategory==='conversations'?'New Conversation':'Add Friend'})]});};export default SideBar;","map":{"version":3,"names":["useEffect","ChatPreview","ContactPreview","Spinner","useChatView","MODAL_TYPE","useSocket","SideBar","socket","isChatViewLoading","handleModal","sideBarCategory","activeView","windowDimensions","setChats","activeChat","setActiveChat","chats","on","updatedChat","removeFlag","updateFlag","checkForDuplicate","prevState","arr","map","chat","_id","filter","priorChatUserNamesAndId","users","userName","sort","updatedChatUserNames","user","existingChatUsersAndId","find","length","every","i","existingChat","some","off","newChat","width","display","flex","sidebar"],"sources":["/Users/griffinbaker/Desktop/chat-application/client/src/components/side-bar/side-bar.component.jsx"],"sourcesContent":["import { useEffect } from 'react';\n// import { ReactComponent as SearchIcon } from '../../assets/search.svg';\nimport ChatPreview from '../chat-preview/chat-preview.component';\nimport './side-bar.styles.scss';\nimport ContactPreview from '../contact-preview/contact-preview.component';\nimport Spinner from '../spinner/spinner.component';\nimport { useChatView, MODAL_TYPE } from '../../contexts/chat-view-context';\nimport { useSocket } from '../../contexts/socket-context';\n\nconst SideBar = () => {\n  const { socket } = useSocket();\n  const {\n    isChatViewLoading,\n    handleModal,\n    sideBarCategory,\n    activeView,\n    windowDimensions,\n    setChats,\n    activeChat,\n    setActiveChat,\n    chats,\n  } = useChatView();\n\n  useEffect(() => {\n    if (!socket) return;\n    socket.on(\n      'updated chat',\n      (\n        updatedChat,\n        removeFlag = null,\n        updateFlag = null,\n        checkForDuplicate = null\n      ) => {\n        if (!removeFlag && !updateFlag) {\n          setChats(prevState => {\n            const arr = prevState.map(chat => {\n              if (chat._id === updatedChat._id) {\n                return updatedChat;\n              } else return chat;\n            });\n            return arr;\n          });\n          return;\n        }\n\n        if (removeFlag) {\n          setChats(prevState => {\n            return prevState.filter(chat => chat._id !== updatedChat._id);\n          });\n          return;\n        }\n\n        const priorChatUserNamesAndId = chats.map(chat => [\n          chat.users.map(({ userName }) => userName).sort(),\n          chat._id,\n        ]);\n\n        const updatedChatUserNames = [...updatedChat.users]\n          .map(user => user.userName)\n          .sort();\n\n        const existingChatUsersAndId = priorChatUserNamesAndId.find(chat => {\n          if (chat[0].length !== updatedChatUserNames.length) return false;\n          return chat[0].every((user, i) => user === updatedChatUserNames[i]);\n        });\n\n        if (existingChatUsersAndId && checkForDuplicate) {\n          const existingChat = chats.find(\n            chat => chat._id === existingChatUsersAndId[1]\n          );\n          setActiveChat([existingChat]);\n          setChats(prevState => {\n            return prevState.filter(chat => chat._id !== updatedChat._id);\n          });\n          return;\n        }\n\n        if (\n          updateFlag &&\n          activeChat[0] &&\n          updatedChat._id === activeChat[0]._id\n        ) {\n          setActiveChat([updatedChat]);\n          setChats(prevState => {\n            const arr = prevState.map(chat => {\n              if (chat._id === updatedChat._id) {\n                return updatedChat;\n              } else return chat;\n            });\n            return arr;\n          });\n          return;\n        } else if (\n          updateFlag &&\n          chats.some(chat => chat._id === updatedChat._id)\n        ) {\n          setChats(prevState => {\n            const arr = prevState.map(chat => {\n              if (chat._id === updatedChat._id) {\n                return updatedChat;\n              } else return chat;\n            });\n            return arr;\n          });\n          return;\n        }\n      }\n    );\n    return () => socket.off('updated chat');\n  }, [socket, setChats, activeChat, setActiveChat, chats]);\n\n  useEffect(() => {\n    if (!socket) return;\n    socket.on('chat creation', newChat => {\n      setChats(prevState => [newChat, ...prevState]);\n    });\n    return () => socket.off('chat creation');\n  }, [socket, setChats]);\n\n  return (\n    <div\n      style={\n        windowDimensions.width > 900\n          ? { width: '31%' }\n          : activeView === 'chat-preview'\n          ? { width: '100%' }\n          : { display: 'none' }\n      }\n      className=\"side-bar-container\"\n    >\n      <div className=\"side-bar-header-title-container\">\n        <p>My Chats</p>\n      </div>\n\n      <div style={{ flex: '1' }}>\n        <ChatPreview />\n        {isChatViewLoading ? <Spinner type=\"search\" /> : <ContactPreview />}\n      </div>\n\n      <button\n        className=\"side-bar-container-generate-button\"\n        onClick={() => handleModal(MODAL_TYPE.sidebar)}\n        type=\"button\"\n      >\n        {sideBarCategory === 'conversations'\n          ? 'New Conversation'\n          : 'Add Friend'}\n      </button>\n    </div>\n  );\n};\n\nexport default SideBar;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}