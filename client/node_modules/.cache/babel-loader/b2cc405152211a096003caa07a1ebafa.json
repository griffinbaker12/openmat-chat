{"ast":null,"code":"import _slicedToArray from\"/Users/griffinbaker/Desktop/chat-application/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{forwardRef,useEffect,useRef}from'react';import{useNavigate}from'react-router-dom';import{useAuthentication}from'../../contexts/authentication-context';import{defaultToast,TOAST_TYPE}from'../../utils/utils';import{useChatView,MODAL_TYPE}from'../../contexts/chat-view-context';import'./account-dropdown.styles.scss';import{useSocket}from'../../contexts/socket-context';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AccountDropdown=/*#__PURE__*/forwardRef(function(_ref,ref){var closeAccountDropdown=_ref.closeAccountDropdown;var navigate=useNavigate();var dropDownRef=useRef();var _useChatView=useChatView(),handleModal=_useChatView.handleModal,setUserInfoModal=_useChatView.setUserInfoModal;var _useAuthentication=useAuthentication(),setCurrentUser=_useAuthentication.setCurrentUser;var _useAuthentication2=useAuthentication(),currentUser=_useAuthentication2.currentUser;var _useSocket=useSocket(),socket=_useSocket.socket,onlineUsers=_useSocket.onlineUsers;var handleSignOutClick=function handleSignOutClick(e){if(ref.current===e.target.closest('.header-chat-link')){return;}if(dropDownRef.current&&!dropDownRef.current.contains(e.target)){closeAccountDropdown();}};useEffect(function(){document.addEventListener('mousedown',handleSignOutClick);return function(){return document.removeEventListener('mousedown',handleSignOutClick);};});var handleAccountClick=function handleAccountClick(){closeAccountDropdown();setUserInfoModal(null,true);handleModal(MODAL_TYPE.userInfo);};var signOutUser=function signOutUser(){localStorage.removeItem('userInfo');navigate('/');var socketOfLoggedOutUser=onlineUsers.filter(function(_ref2){var _ref3=_slicedToArray(_ref2,2),socketId=_ref3[0],userId=_ref3[1];return userId===currentUser._id;})[0][0];console.log(socketOfLoggedOutUser,'logged out socket');socket.emit('log out',currentUser._id,socketOfLoggedOutUser);setCurrentUser(null);defaultToast(TOAST_TYPE.success,'Goodbye üëãüèº');};return/*#__PURE__*/_jsx(\"div\",{onClick:handleSignOutClick,ref:dropDownRef,className:\"account-dropdown-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"account-dropdown-content-container\",children:[/*#__PURE__*/_jsx(\"p\",{onClick:handleAccountClick,children:\"View Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:signOutUser,type:\"button\",children:\"Sign Out\"})]})});});export default AccountDropdown;","map":{"version":3,"names":["forwardRef","useEffect","useRef","useNavigate","useAuthentication","defaultToast","TOAST_TYPE","useChatView","MODAL_TYPE","useSocket","AccountDropdown","ref","closeAccountDropdown","navigate","dropDownRef","handleModal","setUserInfoModal","setCurrentUser","currentUser","socket","onlineUsers","handleSignOutClick","e","current","target","closest","contains","document","addEventListener","removeEventListener","handleAccountClick","userInfo","signOutUser","localStorage","removeItem","socketOfLoggedOutUser","filter","socketId","userId","_id","console","log","emit","success"],"sources":["/Users/griffinbaker/Desktop/chat-application/client/src/components/account-dropdown/account-dropdown.component.jsx"],"sourcesContent":["import { forwardRef, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuthentication } from '../../contexts/authentication-context';\nimport { defaultToast, TOAST_TYPE } from '../../utils/utils';\nimport { useChatView, MODAL_TYPE } from '../../contexts/chat-view-context';\nimport './account-dropdown.styles.scss';\nimport { useSocket } from '../../contexts/socket-context';\n\nconst AccountDropdown = forwardRef(({ closeAccountDropdown }, ref) => {\n  const navigate = useNavigate();\n  const dropDownRef = useRef();\n  const { handleModal, setUserInfoModal } = useChatView();\n  const { setCurrentUser } = useAuthentication();\n\n  const { currentUser } = useAuthentication();\n  const { socket, onlineUsers } = useSocket();\n\n  const handleSignOutClick = e => {\n    if (ref.current === e.target.closest('.header-chat-link')) {\n      return;\n    }\n    if (dropDownRef.current && !dropDownRef.current.contains(e.target)) {\n      closeAccountDropdown();\n    }\n  };\n\n  useEffect(() => {\n    document.addEventListener('mousedown', handleSignOutClick);\n    return () => document.removeEventListener('mousedown', handleSignOutClick);\n  });\n\n  const handleAccountClick = () => {\n    closeAccountDropdown();\n    setUserInfoModal(null, true);\n    handleModal(MODAL_TYPE.userInfo);\n  };\n\n  const signOutUser = () => {\n    localStorage.removeItem('userInfo');\n    navigate('/');\n    const socketOfLoggedOutUser = onlineUsers.filter(\n      ([socketId, userId]) => userId === currentUser._id\n    )[0][0];\n    console.log(socketOfLoggedOutUser, 'logged out socket');\n    socket.emit('log out', currentUser._id, socketOfLoggedOutUser);\n    setCurrentUser(null);\n    defaultToast(TOAST_TYPE.success, 'Goodbye üëãüèº');\n  };\n\n  return (\n    <div\n      onClick={handleSignOutClick}\n      ref={dropDownRef}\n      className=\"account-dropdown-container\"\n    >\n      <div className=\"account-dropdown-content-container\">\n        <p onClick={handleAccountClick}>View Profile</p>\n        <button onClick={signOutUser} type=\"button\">\n          Sign Out\n        </button>\n      </div>\n    </div>\n  );\n});\n\nexport default AccountDropdown;\n"],"mappings":"yIAAA,OAASA,UAAT,CAAqBC,SAArB,CAAgCC,MAAhC,KAA8C,OAA9C,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,OAASC,iBAAT,KAAkC,uCAAlC,CACA,OAASC,YAAT,CAAuBC,UAAvB,KAAyC,mBAAzC,CACA,OAASC,WAAT,CAAsBC,UAAtB,KAAwC,kCAAxC,CACA,MAAO,gCAAP,CACA,OAASC,SAAT,KAA0B,+BAA1B,C,wFAEA,GAAMC,gBAAe,cAAGV,UAAU,CAAC,cAA2BW,GAA3B,CAAmC,IAAhCC,qBAAgC,MAAhCA,oBAAgC,CACpE,GAAMC,SAAQ,CAAGV,WAAW,EAA5B,CACA,GAAMW,YAAW,CAAGZ,MAAM,EAA1B,CACA,iBAA0CK,WAAW,EAArD,CAAQQ,WAAR,cAAQA,WAAR,CAAqBC,gBAArB,cAAqBA,gBAArB,CACA,uBAA2BZ,iBAAiB,EAA5C,CAAQa,cAAR,oBAAQA,cAAR,CAEA,wBAAwBb,iBAAiB,EAAzC,CAAQc,WAAR,qBAAQA,WAAR,CACA,eAAgCT,SAAS,EAAzC,CAAQU,MAAR,YAAQA,MAAR,CAAgBC,WAAhB,YAAgBA,WAAhB,CAEA,GAAMC,mBAAkB,CAAG,QAArBA,mBAAqB,CAAAC,CAAC,CAAI,CAC9B,GAAIX,GAAG,CAACY,OAAJ,GAAgBD,CAAC,CAACE,MAAF,CAASC,OAAT,CAAiB,mBAAjB,CAApB,CAA2D,CACzD,OACD,CACD,GAAIX,WAAW,CAACS,OAAZ,EAAuB,CAACT,WAAW,CAACS,OAAZ,CAAoBG,QAApB,CAA6BJ,CAAC,CAACE,MAA/B,CAA5B,CAAoE,CAClEZ,oBAAoB,GACrB,CACF,CAPD,CASAX,SAAS,CAAC,UAAM,CACd0B,QAAQ,CAACC,gBAAT,CAA0B,WAA1B,CAAuCP,kBAAvC,EACA,MAAO,kBAAMM,SAAQ,CAACE,mBAAT,CAA6B,WAA7B,CAA0CR,kBAA1C,CAAN,EAAP,CACD,CAHQ,CAAT,CAKA,GAAMS,mBAAkB,CAAG,QAArBA,mBAAqB,EAAM,CAC/BlB,oBAAoB,GACpBI,gBAAgB,CAAC,IAAD,CAAO,IAAP,CAAhB,CACAD,WAAW,CAACP,UAAU,CAACuB,QAAZ,CAAX,CACD,CAJD,CAMA,GAAMC,YAAW,CAAG,QAAdA,YAAc,EAAM,CACxBC,YAAY,CAACC,UAAb,CAAwB,UAAxB,EACArB,QAAQ,CAAC,GAAD,CAAR,CACA,GAAMsB,sBAAqB,CAAGf,WAAW,CAACgB,MAAZ,CAC5B,kDAAEC,QAAF,UAAYC,MAAZ,gBAAwBA,OAAM,GAAKpB,WAAW,CAACqB,GAA/C,EAD4B,EAE5B,CAF4B,EAEzB,CAFyB,CAA9B,CAGAC,OAAO,CAACC,GAAR,CAAYN,qBAAZ,CAAmC,mBAAnC,EACAhB,MAAM,CAACuB,IAAP,CAAY,SAAZ,CAAuBxB,WAAW,CAACqB,GAAnC,CAAwCJ,qBAAxC,EACAlB,cAAc,CAAC,IAAD,CAAd,CACAZ,YAAY,CAACC,UAAU,CAACqC,OAAZ,CAAqB,cAArB,CAAZ,CACD,CAVD,CAYA,mBACE,YACE,OAAO,CAAEtB,kBADX,CAEE,GAAG,CAAEP,WAFP,CAGE,SAAS,CAAC,4BAHZ,uBAKE,aAAK,SAAS,CAAC,oCAAf,wBACE,UAAG,OAAO,CAAEgB,kBAAZ,0BADF,cAEE,eAAQ,OAAO,CAAEE,WAAjB,CAA8B,IAAI,CAAC,QAAnC,sBAFF,GALF,EADF,CAcD,CAvDiC,CAAlC,CAyDA,cAAetB,gBAAf"},"metadata":{},"sourceType":"module"}