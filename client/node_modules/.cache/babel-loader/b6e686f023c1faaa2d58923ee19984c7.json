{"ast":null,"code":"var _jsxFileName = \"/Users/griffinbaker/Desktop/chat-application/client/src/contexts/sidebar-context.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, useEffect, useState } from 'react';\nimport { useAuthentication } from './authentication-context';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SidebarContext = /*#__PURE__*/createContext();\nexport const useSidebar = () => {\n  _s();\n\n  return useContext(SidebarContext);\n};\n\n_s(useSidebar, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport const SIDEBAR_CATEGORY_TYPE = {\n  conversations: 'conversations',\n  friends: 'friends'\n};\nexport const SidebarProvider = _ref => {\n  _s2();\n\n  let {\n    children\n  } = _ref;\n  const [search, setSearch] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [searchResults, setSearchResults] = useState([]);\n  const [sideBarCategory, setSideBarCategory] = useState(SIDEBAR_CATEGORY_TYPE.conversations);\n  const [showModal, setShowModal] = useState(false);\n  const [chats, setChats] = useState([]);\n  const {\n    currentUser\n  } = useAuthentication();\n\n  const updateSearchValue = e => setSearch(e.target.value);\n\n  const fetchChats = async () => {\n    try {\n      console.log('running');\n      const response = await fetch(`http://localhost:4000/api/chat`, {\n        method: 'get',\n        headers: {\n          Authorization: `Bearer ${currentUser.token}`\n        }\n      });\n      const data = await response.json();\n      setChats(data);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  const handleSearchSubmit = async e => {\n    e.preventDefault();\n    if (!search) return; // Spinner until you get the results, fetch them\n\n    try {\n      setIsLoading(true); // I almost like the feature where you keep the search text there so that you know what you searched, and then once you hit the x then the results unfilter and are based off of the time the last message was sent\n      // setSearch('');\n\n      const response = await fetch(`http://localhost:4000/api/user?search=${search}`, {\n        method: 'get',\n        headers: {\n          Authorization: `Bearer ${currentUser.token}`\n        }\n      });\n      const {\n        messages,\n        users\n      } = await response.json();\n      setIsLoading(false);\n      setSearchResults([{\n        messages,\n        users\n      }]);\n    } catch (e) {\n      console.log(e, 'Failed to load search results');\n    }\n  }; // Fetch the chats once, and then otherwise just add the chats to the data, don't need to re-fetch or anything like that\n\n\n  useEffect(() => {\n    console.log(Boolean(currentUser), currentUser, 'current usr from sidebar');\n\n    if (currentUser) {\n      fetchChats();\n    }\n\n    return;\n  }, [currentUser]);\n  return /*#__PURE__*/_jsxDEV(SidebarContext.Provider, {\n    value: {\n      search,\n      updateSearchValue,\n      isLoading,\n      searchResults,\n      sideBarCategory,\n      setSideBarCategory,\n      setIsLoading,\n      setSearchResults,\n      showModal,\n      setShowModal,\n      handleSearchSubmit\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n\n_s2(SidebarProvider, \"M1RTXVmic09y6rCdM3raWVLkhRY=\", false, function () {\n  return [useAuthentication];\n});\n\n_c = SidebarProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"SidebarProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","useAuthentication","SidebarContext","useSidebar","SIDEBAR_CATEGORY_TYPE","conversations","friends","SidebarProvider","children","search","setSearch","isLoading","setIsLoading","searchResults","setSearchResults","sideBarCategory","setSideBarCategory","showModal","setShowModal","chats","setChats","currentUser","updateSearchValue","e","target","value","fetchChats","console","log","response","fetch","method","headers","Authorization","token","data","json","handleSearchSubmit","preventDefault","messages","users","Boolean"],"sources":["/Users/griffinbaker/Desktop/chat-application/client/src/contexts/sidebar-context.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from 'react';\nimport { useAuthentication } from './authentication-context';\n\nconst SidebarContext = createContext();\n\nexport const useSidebar = () => useContext(SidebarContext);\n\nexport const SIDEBAR_CATEGORY_TYPE = {\n  conversations: 'conversations',\n  friends: 'friends',\n};\n\nexport const SidebarProvider = ({ children }) => {\n  const [search, setSearch] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [searchResults, setSearchResults] = useState([]);\n  const [sideBarCategory, setSideBarCategory] = useState(\n    SIDEBAR_CATEGORY_TYPE.conversations\n  );\n  const [showModal, setShowModal] = useState(false);\n  const [chats, setChats] = useState([]);\n  const { currentUser } = useAuthentication();\n\n  const updateSearchValue = e => setSearch(e.target.value);\n\n  const fetchChats = async () => {\n    try {\n      console.log('running');\n      const response = await fetch(`http://localhost:4000/api/chat`, {\n        method: 'get',\n        headers: { Authorization: `Bearer ${currentUser.token}` },\n      });\n      const data = await response.json();\n      setChats(data);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  const handleSearchSubmit = async e => {\n    e.preventDefault();\n    if (!search) return;\n\n    // Spinner until you get the results, fetch them\n\n    try {\n      setIsLoading(true);\n\n      // I almost like the feature where you keep the search text there so that you know what you searched, and then once you hit the x then the results unfilter and are based off of the time the last message was sent\n      // setSearch('');\n\n      const response = await fetch(\n        `http://localhost:4000/api/user?search=${search}`,\n        {\n          method: 'get',\n          headers: { Authorization: `Bearer ${currentUser.token}` },\n        }\n      );\n      const { messages, users } = await response.json();\n      setIsLoading(false);\n      setSearchResults([{ messages, users }]);\n    } catch (e) {\n      console.log(e, 'Failed to load search results');\n    }\n  };\n\n  // Fetch the chats once, and then otherwise just add the chats to the data, don't need to re-fetch or anything like that\n\n  useEffect(() => {\n    console.log(Boolean(currentUser), currentUser, 'current usr from sidebar');\n    if (currentUser) {\n      fetchChats();\n    }\n    return;\n  }, [currentUser]);\n\n  return (\n    <SidebarContext.Provider\n      value={{\n        search,\n        updateSearchValue,\n        isLoading,\n        searchResults,\n        sideBarCategory,\n        setSideBarCategory,\n        setIsLoading,\n        setSearchResults,\n        showModal,\n        setShowModal,\n        handleSearchSubmit,\n      }}\n    >\n      {children}\n    </SidebarContext.Provider>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}