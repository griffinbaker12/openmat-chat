{"ast":null,"code":"var _jsxFileName = \"/Users/griffinbaker/Desktop/chat-application/client/src/contexts/chat-view-context.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, useEffect, useState, useCallback } from 'react';\nimport { useAuthentication } from './authentication-context';\nimport { toast } from 'react-toastify';\nimport { useNavigate } from 'react-router-dom'; // import { useSocket } from './socket-context';\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatViewContext = /*#__PURE__*/createContext();\nexport const useChatView = () => {\n  _s();\n\n  return useContext(ChatViewContext);\n};\n\n_s(useChatView, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport const SIDEBAR_CATEGORY_TYPE = {\n  conversations: 'conversations',\n  friends: 'friends'\n};\nexport const MODAL_TYPE = {\n  sidebar: 'sidebar',\n  chatInfo: 'chatInfo'\n};\nexport const ChatViewProvider = _ref => {\n  _s2();\n\n  let {\n    children\n  } = _ref;\n  const [activeChat, setActiveChat] = useState([]);\n  const [search, setSearch] = useState('');\n  const [isChatViewLoading, setIsChatViewLoading] = useState(false);\n  const [searchResults, setSearchResults] = useState([]);\n  const [sideBarCategory, setSideBarCategory] = useState(SIDEBAR_CATEGORY_TYPE.conversations);\n  const [showModal, setShowModal] = useState(false);\n  const [showAddUserInfoDropdown, setShowAddUserInfoDropdown] = useState(false);\n  const [modalType, setModalType] = useState('');\n  const [chats, setChats] = useState([]);\n  const [activeFriend, setActiveFriend] = useState('');\n  const [friends, setFriends] = useState([]);\n  const {\n    currentUser,\n    setIsLoading\n  } = useAuthentication();\n  const navigate = useNavigate();\n\n  const closeModal = () => {\n    if (showAddUserInfoDropdown) {\n      setShowAddUserInfoDropdown(false);\n      return;\n    }\n\n    setShowModal(false);\n  };\n\n  const updateSearchValue = e => setSearch(e.target.value);\n\n  const fetchChats = useCallback(async function () {\n    let tokenForLogin = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n    try {\n      const response = await fetch(`http://localhost:4000/api/chat`, {\n        method: 'get',\n        headers: {\n          Authorization: `Bearer ${tokenForLogin || currentUser.token}`\n        }\n      });\n      const data = await response.json();\n      setChats(data);\n\n      if (tokenForLogin) {\n        navigate('/chat');\n        setIsLoading(false);\n        toast.success('Login success', {\n          position: 'bottom-center',\n          autoClose: 3000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined,\n          theme: 'dark'\n        });\n      }\n    } catch (e) {\n      toast.error('Error fetching chats', {\n        position: 'bottom-center',\n        autoClose: 3000,\n        hideProgressBar: false,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        progress: undefined,\n        theme: 'dark'\n      });\n    }\n  }, [currentUser, navigate, setIsLoading]);\n\n  const handleModal = function (modalType) {\n    let friendId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    // Not sure what I was thinking for this as of right now\n    // If the friend has not changed, do not do this loop\n    // const friend = friends.find(friend => friend._id === friendId);\n    // setActiveFriend(friend);\n    setModalType(modalType);\n    setShowModal(true);\n  };\n\n  const handleSearchSubmit = async e => {\n    e.preventDefault();\n    if (!search) return;\n\n    try {\n      setIsChatViewLoading(true); // I almost like the feature where you keep the search text there so that you know what you searched, and then once you hit the x then the results unfilter and are based off of the time the last message was sent\n      // setSearch('');\n\n      const response = await fetch(`http://localhost:4000/api/user?search=${search}`, {\n        method: 'get',\n        headers: {\n          Authorization: `Bearer ${currentUser.token}`\n        }\n      });\n      const {\n        messages,\n        users\n      } = await response.json();\n      setIsChatViewLoading(false);\n      setSearchResults([{\n        messages,\n        users\n      }]);\n    } catch (e) {\n      toast.error('Error fetching results', {\n        position: 'bottom-center',\n        autoClose: 3000,\n        hideProgressBar: false,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        progress: undefined,\n        theme: 'dark'\n      });\n    }\n  }; // Fetch the chats once, and then otherwise just add the chats to the data, don't need to re-fetch or anything like that. Could keep this here or do something where you only fetch the chats and the friends once the user is actually signed in. That could also be a route where you just find these two things\n\n\n  useEffect(() => {\n    if (!currentUser) {\n      setChats([]);\n      setActiveChat([]);\n      return;\n    }\n\n    if (currentUser._id) {\n      fetchChats();\n    }\n\n    return;\n  }, [currentUser, fetchChats]);\n  useEffect(() => {\n    if (chats.length === 0) return;else {\n      const activeChat = chats[0];\n      setActiveChat([activeChat]);\n    }\n  }, [chats]);\n  useEffect(() => {\n    if (!currentUser) return;\n    setFriends(currentUser.friends);\n  }, [currentUser]);\n  return /*#__PURE__*/_jsxDEV(ChatViewContext.Provider, {\n    value: {\n      activeChat,\n      setActiveChat,\n      handleModal,\n      closeModal,\n      handleSearchSubmit,\n      updateSearchValue,\n      chats,\n      setChats,\n      showModal,\n      setSideBarCategory,\n      sideBarCategory,\n      modalType,\n      fetchChats,\n      setShowModal,\n      showAddUserInfoDropdown,\n      setShowAddUserInfoDropdown\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 168,\n    columnNumber: 5\n  }, this);\n};\n\n_s2(ChatViewProvider, \"+6lpu93h5/aK3etipaOtJZUm6y8=\", false, function () {\n  return [useAuthentication, useNavigate];\n});\n\n_c = ChatViewProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChatViewProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","useCallback","useAuthentication","toast","useNavigate","ChatViewContext","useChatView","SIDEBAR_CATEGORY_TYPE","conversations","friends","MODAL_TYPE","sidebar","chatInfo","ChatViewProvider","children","activeChat","setActiveChat","search","setSearch","isChatViewLoading","setIsChatViewLoading","searchResults","setSearchResults","sideBarCategory","setSideBarCategory","showModal","setShowModal","showAddUserInfoDropdown","setShowAddUserInfoDropdown","modalType","setModalType","chats","setChats","activeFriend","setActiveFriend","setFriends","currentUser","setIsLoading","navigate","closeModal","updateSearchValue","e","target","value","fetchChats","tokenForLogin","response","fetch","method","headers","Authorization","token","data","json","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","theme","error","handleModal","friendId","handleSearchSubmit","preventDefault","messages","users","_id","length"],"sources":["/Users/griffinbaker/Desktop/chat-application/client/src/contexts/chat-view-context.js"],"sourcesContent":["import {\n  createContext,\n  useContext,\n  useEffect,\n  useState,\n  useCallback,\n} from 'react';\nimport { useAuthentication } from './authentication-context';\nimport { toast } from 'react-toastify';\nimport { useNavigate } from 'react-router-dom';\n// import { useSocket } from './socket-context';\n\nconst ChatViewContext = createContext();\n\nexport const useChatView = () => useContext(ChatViewContext);\n\nexport const SIDEBAR_CATEGORY_TYPE = {\n  conversations: 'conversations',\n  friends: 'friends',\n};\n\nexport const MODAL_TYPE = {\n  sidebar: 'sidebar',\n  chatInfo: 'chatInfo',\n};\n\nexport const ChatViewProvider = ({ children }) => {\n  const [activeChat, setActiveChat] = useState([]);\n  const [search, setSearch] = useState('');\n  const [isChatViewLoading, setIsChatViewLoading] = useState(false);\n  const [searchResults, setSearchResults] = useState([]);\n  const [sideBarCategory, setSideBarCategory] = useState(\n    SIDEBAR_CATEGORY_TYPE.conversations\n  );\n  const [showModal, setShowModal] = useState(false);\n  const [showAddUserInfoDropdown, setShowAddUserInfoDropdown] = useState(false);\n  const [modalType, setModalType] = useState('');\n  const [chats, setChats] = useState([]);\n  const [activeFriend, setActiveFriend] = useState('');\n  const [friends, setFriends] = useState([]);\n\n  const { currentUser, setIsLoading } = useAuthentication();\n  const navigate = useNavigate();\n\n  const closeModal = () => {\n    if (showAddUserInfoDropdown) {\n      setShowAddUserInfoDropdown(false);\n      return;\n    }\n    setShowModal(false);\n  };\n\n  const updateSearchValue = e => setSearch(e.target.value);\n\n  const fetchChats = useCallback(\n    async (tokenForLogin = null) => {\n      try {\n        const response = await fetch(`http://localhost:4000/api/chat`, {\n          method: 'get',\n          headers: {\n            Authorization: `Bearer ${tokenForLogin || currentUser.token}`,\n          },\n        });\n        const data = await response.json();\n        setChats(data);\n        if (tokenForLogin) {\n          navigate('/chat');\n          setIsLoading(false);\n          toast.success('Login success', {\n            position: 'bottom-center',\n            autoClose: 3000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined,\n            theme: 'dark',\n          });\n        }\n      } catch (e) {\n        toast.error('Error fetching chats', {\n          position: 'bottom-center',\n          autoClose: 3000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined,\n          theme: 'dark',\n        });\n      }\n    },\n    [currentUser, navigate, setIsLoading]\n  );\n\n  const handleModal = (modalType, friendId = null) => {\n    // Not sure what I was thinking for this as of right now\n    // If the friend has not changed, do not do this loop\n    // const friend = friends.find(friend => friend._id === friendId);\n    // setActiveFriend(friend);\n\n    setModalType(modalType);\n    setShowModal(true);\n  };\n\n  const handleSearchSubmit = async e => {\n    e.preventDefault();\n    if (!search) return;\n\n    try {\n      setIsChatViewLoading(true);\n\n      // I almost like the feature where you keep the search text there so that you know what you searched, and then once you hit the x then the results unfilter and are based off of the time the last message was sent\n      // setSearch('');\n\n      const response = await fetch(\n        `http://localhost:4000/api/user?search=${search}`,\n        {\n          method: 'get',\n          headers: { Authorization: `Bearer ${currentUser.token}` },\n        }\n      );\n      const { messages, users } = await response.json();\n      setIsChatViewLoading(false);\n      setSearchResults([{ messages, users }]);\n    } catch (e) {\n      toast.error('Error fetching results', {\n        position: 'bottom-center',\n        autoClose: 3000,\n        hideProgressBar: false,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        progress: undefined,\n        theme: 'dark',\n      });\n    }\n  };\n\n  // Fetch the chats once, and then otherwise just add the chats to the data, don't need to re-fetch or anything like that. Could keep this here or do something where you only fetch the chats and the friends once the user is actually signed in. That could also be a route where you just find these two things\n\n  useEffect(() => {\n    if (!currentUser) {\n      setChats([]);\n      setActiveChat([]);\n      return;\n    }\n    if (currentUser._id) {\n      fetchChats();\n    }\n    return;\n  }, [currentUser, fetchChats]);\n\n  useEffect(() => {\n    if (chats.length === 0) return;\n    else {\n      const activeChat = chats[0];\n      setActiveChat([activeChat]);\n    }\n  }, [chats]);\n\n  useEffect(() => {\n    if (!currentUser) return;\n    setFriends(currentUser.friends);\n  }, [currentUser]);\n\n  return (\n    <ChatViewContext.Provider\n      value={{\n        activeChat,\n        setActiveChat,\n        handleModal,\n        closeModal,\n        handleSearchSubmit,\n        updateSearchValue,\n        chats,\n        setChats,\n        showModal,\n        setSideBarCategory,\n        sideBarCategory,\n        modalType,\n        fetchChats,\n        setShowModal,\n        showAddUserInfoDropdown,\n        setShowAddUserInfoDropdown,\n      }}\n    >\n      {children}\n    </ChatViewContext.Provider>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}