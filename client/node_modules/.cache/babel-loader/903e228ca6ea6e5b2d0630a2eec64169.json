{"ast":null,"code":"var _jsxFileName = \"/Users/griffinbaker/Desktop/chat-application/client/src/components/user-info-modal/user-info-modal.component.jsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport { useAuthentication } from '../../contexts/authentication-context';\nimport { useChatView } from '../../contexts/chat-view-context';\nimport { defaultToast, TOAST_TYPE } from '../../utils/utils';\nimport './user-info-modal.styles.scss'; // This could easily be made more generalizable by saying activeUser and then whatever user you click on will have the same profile\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst UserInfoModal = () => {\n  _s();\n\n  const {\n    activeUserInfo,\n    showModal,\n    closeModal,\n    isActiveUserCurrentUser,\n    setShowActiveUserWithinChatInfo,\n    showActiveUserWithinChatInfo,\n    chats,\n    setActiveChat,\n    setChats,\n    activeChat\n  } = useChatView();\n  const {\n    currentUser\n  } = useAuthentication();\n  const [showDropdown, setShowDropdown] = useState(false); // When you look at their profile, you should be able to chat them, remove or add them as a friend, see their friends...TOMORROW!\n  // Could be cool to be able to click either the chats or friends and then re-direct the user to the left hand side to either their chats or their friends. Also, if the active current user IS NOT the current user, then we need to show a back arrow to go back to the active chat\n\n  const goBackToChatInfo = () => setShowActiveUserWithinChatInfo(false);\n\n  const handleChatCreation = async e => {\n    e.stopPropagation();\n    const soloChats = chats.filter(chat => !chat.isGroupChat);\n    const existingChat = soloChats.find(chat => chat.users.some(user => user._id === activeUserInfo._id));\n\n    if (existingChat) {\n      var _activeChat$;\n\n      closeModal();\n      closeDropdown();\n      if (((_activeChat$ = activeChat[0]) === null || _activeChat$ === void 0 ? void 0 : _activeChat$._id) === existingChat._id) return;\n      setActiveChat([existingChat]);\n    } else {\n      const otherParticipantId = [activeUserInfo._id];\n      const payload = {\n        chatName: null,\n        users: otherParticipantId\n      };\n\n      try {\n        const response = await fetch(`http://localhost:4000/api/chat/createChat`, {\n          method: 'post',\n          headers: {\n            Authorization: `Bearer ${currentUser.token}`,\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(payload)\n        });\n        const newChat = await response.json();\n        setChats(prevState => [newChat, ...prevState]);\n        closeModal();\n        closeDropdown();\n        defaultToast(TOAST_TYPE.success, 'Chat creation successful');\n      } catch (e) {\n        defaultToast(TOAST_TYPE.failure, 'Error creating chat');\n      }\n    }\n  }; // const handleDropdown = () => {\n  //   setShowDropdown(prevState => !prevState);\n  // };\n\n\n  const handleModalClick = e => {\n    e.stopPropagation();\n\n    if (showDropdown) {\n      setShowDropdown(false);\n      return;\n    }\n\n    closeModal();\n  };\n\n  const closeDropdown = () => setShowDropdown(false);\n\n  const closeUserInfoDropdownAndStopPropagation = e => {\n    const ellipsisPress = e.target.closest('.user-info-modal-back-ellipsis');\n    e.stopPropagation();\n\n    if (!ellipsisPress) {\n      setShowDropdown(false);\n    }\n  };\n\n  useEffect(() => {\n    document.addEventListener('click', closeUserInfoDropdownAndStopPropagation);\n    return () => document.removeEventListener('click', closeUserInfoDropdownAndStopPropagation);\n  });\n  return activeUserInfo && showActiveUserWithinChatInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `user-info-modal-container ${showModal ? 'active' : ''}`,\n    onClick: handleModalClick,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"user-info-modal-content\",\n      onClick: closeUserInfoDropdownAndStopPropagation,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: isActiveUserCurrentUser ? {\n          visibility: 'visible',\n          marginBottom: '4px'\n        } : {\n          display: 'none'\n        },\n        className: \"user-info-modal-button-container\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: closeModal,\n          type: \"button\",\n          style: {\n            color: 'white'\n          },\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-info-modal-user-detail-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user-info-modal-user-detail-header-with-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            onClick: goBackToChatInfo,\n            className: \"user-info-modal-back-arrow\",\n            style: isActiveUserCurrentUser ? {\n              visibility: 'hidden'\n            } : {\n              fontSize: '24px'\n            },\n            children: \"\\u2190\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"user-info-modal-name\",\n            children: activeUserInfo.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user-info-modal-username-email\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"@\", activeUserInfo.userName]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user-info-modal-picture-container\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            height: \"100%\",\n            src: activeUserInfo.picture,\n            alt: \"profile\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleChatCreation,\n        className: \"user-info-button\",\n        children: \"Send Message\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 7\n  }, this);\n};\n\n_s(UserInfoModal, \"ynPNY6mWmLIU1y1GooGCj+y8Gnw=\", false, function () {\n  return [useChatView, useAuthentication];\n});\n\n_c = UserInfoModal;\nexport default UserInfoModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserInfoModal\");","map":{"version":3,"names":["useEffect","useState","useAuthentication","useChatView","defaultToast","TOAST_TYPE","UserInfoModal","activeUserInfo","showModal","closeModal","isActiveUserCurrentUser","setShowActiveUserWithinChatInfo","showActiveUserWithinChatInfo","chats","setActiveChat","setChats","activeChat","currentUser","showDropdown","setShowDropdown","goBackToChatInfo","handleChatCreation","e","stopPropagation","soloChats","filter","chat","isGroupChat","existingChat","find","users","some","user","_id","closeDropdown","otherParticipantId","payload","chatName","response","fetch","method","headers","Authorization","token","body","JSON","stringify","newChat","json","prevState","success","failure","handleModalClick","closeUserInfoDropdownAndStopPropagation","ellipsisPress","target","closest","document","addEventListener","removeEventListener","visibility","marginBottom","display","color","fontSize","name","userName","picture"],"sources":["/Users/griffinbaker/Desktop/chat-application/client/src/components/user-info-modal/user-info-modal.component.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useAuthentication } from '../../contexts/authentication-context';\nimport { useChatView } from '../../contexts/chat-view-context';\nimport { defaultToast, TOAST_TYPE } from '../../utils/utils';\nimport './user-info-modal.styles.scss';\n\n// This could easily be made more generalizable by saying activeUser and then whatever user you click on will have the same profile\n\nconst UserInfoModal = () => {\n  const {\n    activeUserInfo,\n    showModal,\n    closeModal,\n    isActiveUserCurrentUser,\n    setShowActiveUserWithinChatInfo,\n    showActiveUserWithinChatInfo,\n    chats,\n    setActiveChat,\n    setChats,\n    activeChat,\n  } = useChatView();\n\n  const { currentUser } = useAuthentication();\n\n  const [showDropdown, setShowDropdown] = useState(false);\n\n  // When you look at their profile, you should be able to chat them, remove or add them as a friend, see their friends...TOMORROW!\n\n  // Could be cool to be able to click either the chats or friends and then re-direct the user to the left hand side to either their chats or their friends. Also, if the active current user IS NOT the current user, then we need to show a back arrow to go back to the active chat\n\n  const goBackToChatInfo = () => setShowActiveUserWithinChatInfo(false);\n\n  const handleChatCreation = async e => {\n    e.stopPropagation();\n\n    const soloChats = chats.filter(chat => !chat.isGroupChat);\n\n    const existingChat = soloChats.find(chat =>\n      chat.users.some(user => user._id === activeUserInfo._id)\n    );\n\n    if (existingChat) {\n      closeModal();\n      closeDropdown();\n      if (activeChat[0]?._id === existingChat._id) return;\n      setActiveChat([existingChat]);\n    } else {\n      const otherParticipantId = [activeUserInfo._id];\n      const payload = {\n        chatName: null,\n        users: otherParticipantId,\n      };\n\n      try {\n        const response = await fetch(\n          `http://localhost:4000/api/chat/createChat`,\n          {\n            method: 'post',\n            headers: {\n              Authorization: `Bearer ${currentUser.token}`,\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(payload),\n          }\n        );\n        const newChat = await response.json();\n        setChats(prevState => [newChat, ...prevState]);\n        closeModal();\n        closeDropdown();\n        defaultToast(TOAST_TYPE.success, 'Chat creation successful');\n      } catch (e) {\n        defaultToast(TOAST_TYPE.failure, 'Error creating chat');\n      }\n    }\n  };\n\n  // const handleDropdown = () => {\n  //   setShowDropdown(prevState => !prevState);\n  // };\n\n  const handleModalClick = e => {\n    e.stopPropagation();\n    if (showDropdown) {\n      setShowDropdown(false);\n      return;\n    }\n    closeModal();\n  };\n\n  const closeDropdown = () => setShowDropdown(false);\n\n  const closeUserInfoDropdownAndStopPropagation = e => {\n    const ellipsisPress = e.target.closest('.user-info-modal-back-ellipsis');\n    e.stopPropagation();\n\n    if (!ellipsisPress) {\n      setShowDropdown(false);\n    }\n  };\n\n  useEffect(() => {\n    document.addEventListener('click', closeUserInfoDropdownAndStopPropagation);\n    return () =>\n      document.removeEventListener(\n        'click',\n        closeUserInfoDropdownAndStopPropagation\n      );\n  });\n\n  return (\n    activeUserInfo &&\n    showActiveUserWithinChatInfo && (\n      <div\n        className={`user-info-modal-container ${showModal ? 'active' : ''}`}\n        onClick={handleModalClick}\n      >\n        <div\n          className=\"user-info-modal-content\"\n          onClick={closeUserInfoDropdownAndStopPropagation}\n        >\n          <div\n            style={\n              isActiveUserCurrentUser\n                ? { visibility: 'visible', marginBottom: '4px' }\n                : { display: 'none' }\n            }\n            className=\"user-info-modal-button-container\"\n          >\n            <button\n              onClick={closeModal}\n              type=\"button\"\n              style={{ color: 'white' }}\n            >\n              &#x2715;\n            </button>\n          </div>\n          <div className=\"user-info-modal-user-detail-container\">\n            <div className=\"user-info-modal-user-detail-header-with-buttons\">\n              <div\n                onClick={goBackToChatInfo}\n                className=\"user-info-modal-back-arrow\"\n                style={\n                  isActiveUserCurrentUser\n                    ? { visibility: 'hidden' }\n                    : {\n                        fontSize: '24px',\n                      }\n                }\n              >\n                &#8592;\n              </div>\n              <p className=\"user-info-modal-name\">{activeUserInfo.name}</p>\n            </div>\n            <div className=\"user-info-modal-username-email\">\n              <p>@{activeUserInfo.userName}</p>\n            </div>\n            <div className=\"user-info-modal-picture-container\">\n              <img height=\"100%\" src={activeUserInfo.picture} alt=\"profile\" />\n            </div>\n          </div>\n          <button onClick={handleChatCreation} className=\"user-info-button\">\n            Send Message\n          </button>\n        </div>\n      </div>\n    )\n  );\n};\n\nexport default UserInfoModal;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}